<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì§€í•˜ì²  ì‹¤ì‹œê°„ ë„ì°© ì •ë³´</title>
    <script>
        async function fetchStationData() {
            const stationName = document.getElementById("stationName").value;
            if (!stationName) {
                alert("ì—­ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                return;
            }

            const response = await fetch("/station_name", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({ stationName })
            });

            if (!response.ok) {
                alert("ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
                return;
            }

            const data = await response.json();
            displayData(data);
        }

        function displayData(data) {
            const resultDiv = document.getElementById("result");
            resultDiv.innerHTML = ""; 
            
            if (data.length === 0) {
                resultDiv.innerHTML = "<p>í•´ë‹¹ ì—­ì— ëŒ€í•œ ì‹¤ì‹œê°„ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.</p>";
                return;
            }
            
            const table = document.createElement("table");
            table.border = "1";
            const headerRow = table.insertRow();
            ["ì§€í•˜ì²  ID", "ìƒí•˜í–‰ì„ ", "ë…¸ì„  ì •ë³´", "ì—­ ì´ë¦„", "ë„ì°© ì‹œê°„", "ìƒíƒœ", "ì—´ì°¨ ë²ˆí˜¸"].forEach(text => {
                const th = document.createElement("th");
                th.textContent = text;
                headerRow.appendChild(th);
            });
            
            data.forEach(item => {
                const row = table.insertRow();
                [item.subwayId, item.updnLine, item.trainLineNm, item.stationNm, item.arrivalTime, item.status, item.trainNo].forEach(text => {
                    const cell = row.insertCell();
                    cell.textContent = text;
                });
            });
            
            resultDiv.appendChild(table);
        }
        async function fetchStationData() {
    const stationName = document.getElementById("stationName").value;
    if (!stationName) {
        alert("ì—­ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
        return;
    }

    try {
        const response = await fetch("http://localhost:3000/station_name", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({ stationName })
        });

        console.log("ğŸ”„ Response Status:", response.status);

        if (!response.ok) {
            const errorText = await response.text();
            console.error("ğŸš¨ Error Response:", errorText);
            alert(`âŒ ì˜¤ë¥˜ ë°œìƒ: ${errorText}`);
            return;
        }

        const data = await response.json();
        console.log("âœ… ì„œë²„ ì‘ë‹µ ë°ì´í„°:", data);
        displayData(data);
    } catch (error) {
        console.error("âš ï¸ Fetch Error:", error);
        alert("ìš”ì²­ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
    }
}

    </script>
</head>
<body>
    <h2>ì§€í•˜ì²  ì‹¤ì‹œê°„ ë„ì°© ì •ë³´</h2>
    <input type="text" id="stationName" placeholder="ì—­ ì´ë¦„ ì…ë ¥">
    <button onclick="fetchStationData()">ê²€ìƒ‰</button>
    <div id="result"></div>
</body>
</html>